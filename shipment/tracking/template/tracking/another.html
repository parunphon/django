<!DOCTYPE HTML>
<html>

<script>
    function GetSelectedText(group_bot){
        var e = document.getElementById(group_bot);
        var result = e.options[e.selectedIndex].text;
        return confirm('Do you want to run BOT : ' + result + '  ?');
    }
</script>

<head>

<!Script for Custom Confirm Box>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script>
  $( function() {
    $( "#dialog-confirm" ).dialog({
      resizable: false,
      width: 350,
      buttons: {
        "Continue": function() {
          $( this ).dialog( "close" );
        },
        "Download Logfile": function() {
          $( this ).dialog( "close" );

          window.open('/download/'+ '{{ script_name }}','_blank');

        }
      }
    });
  } );
</script>

<!Script for Date Time Picker>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>
  $( function() {
    $( "#datepicker1" ).datepicker({
      dateFormat: 'yy-mm-dd'
    });
    $( "#datepicker2" ).datepicker({
      dateFormat: 'yy-mm-dd'
    });
  } );
</script>

<!Script for Waiting Sign>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
<script>
$(function($) {
"use strict";
    // global hook - unblock UI when ajax request completes
    $(document).ajaxStop($.unblockUI);
    $('#no').bind('click', $.unblockUI);
});

 $(document).ready(function() {
    $('#another_form').submit(function() {
        $.blockUI({ css: {
            border: 'none',
            padding: '15px',
            backgroundColor: '#000',
            '-webkit-border-radius': '10px',
            '-moz-border-radius': '10px',
            opacity: .5,
            color: '#fff'
        } });
        setTimeout($.unblockUI, 600000);
    }); 
    $( "#datepicker1" ).datepicker({
      dateFormat: 'yy-mm-dd'
    });
    $( "#datepicker2" ).datepicker({
      dateFormat: 'yy-mm-dd'
    });
});
</script>

  <title>INSEE Logistics Excellent BOT Portal Website</title>
  <meta name="description" content="website description" />
  <meta name="keywords" content="website keywords, website keywords" />
  <meta http-equiv="content-type" content="text/html; charset=windows-1252" />
   
  {% load static %}
  <link rel="stylesheet" type="text/css" href="{% static 'style.css' %}" />
</head>

<body>
  <div id="main">
    <div id="header">
      <div id="logo">
        <div id="logo_text">
          <!-- class="logo_colour", allows you to change the colour of the text -->
          <h1><a href="/">INSEE_LogEX<span class="logo_colour">BOT Portal</span></a></h1>
          <h2>Simpler. Faster. Better. Logistics Excellent BOT Portal Website.</h2>
        </div>
      </div>
      
    
    <!-- ############## Check User Authenticated ############# -->
    {% if user.is_authenticated %}
    
     
    <!-- ############## Check User Group ############# -->
      {% for group in user.groups.all %}
        {% if group.name == 'admin' %}
        
<!-- ############################### Admin Group Page ################################################### -->

    <!-- ############## Menu Content ############# -->      
      <div id="menubar">
        <ul id="menu">
          <!-- put class="selected" in the li tag for the selected page - to highlight which page you're on -->
          <li><a href="/">Home</a></li>
          <li><a href="/bot/">Run BOT</a></li>
          <li><a href="/sql/">SQL Page</a></li>
          <li><a href="/botlog/">BOT & Log</a></li>
          <li class="selected"><a href="/another/">BOT & Parameter</a></li>
          <li><a href="/contact/">Contact Us</a></li>
        </ul>
      </div>
    </div>

    <!-- ############## Header Content ############# -->
    <div id="content_header"></div>
    <div id="site_content">
      <div class="sidebar">
        <!-- insert your sidebar items here -->
        <h3>Latest News</h3>
        <h4>New BOT Portal Website Launched</h4>
        <h5>August 02, 2021</h5>
        <p>2021 sees the design and function of our bot portal website. Take a look around and let us know what you think.<br />
        <p></p>

        <h4>Browser Compatibility for Running BOT</h4>
        <p>This template has been tested in the following browsers:</p>
          <li>Google Chrome 6</li>
          <li>Microsoft Edge</li>
          <li>Internet Explorer 7</li>
          <li>FireFox 3.5</li>
          <li>Safari 4</li>
        
        <h3>Search</h3>
        <form method="post" action="#" id="search_form">
          <p>
            <input class="search" type="text" name="search_field" value="Enter keywords....." />
            <input name="search" type="image" style="border: 0; margin: 0 0 -9px 5px;" src="{% static 'search.png' %}" alt="Search" title="Search" />
          </p>
        </form>
      </div>
      
      <!-- ############## Main Content ############# -->
      <div id="content">
        <!-- insert the page content here -->
       <h4>Role : SCCC OTM Admin (Admin)</h4> 
       <h1>BOT Execution with Parameter</h1>
        <p>Below is BOT Template with Parameter</p>
        <form action="" method="post" id="another_form">
        <div class="form_settings">
          
        <script>
            $(function(){
                    $('#Bot_with_Parameter').change(function(){
                        $('input[type=text]').val('');
                        
                        $('#datepicker1').attr('disabled', true);     
                        $('#datepicker2').attr('disabled', true);
                        $('#shipment').attr('disabled', true);     
                        $('#cpdo').attr('disabled',true );
                        $('#filename').attr('disabled', true);

                    if($(this).val()=="Use_Below_BOT") {
                        $('#filename').attr('disabled', true);
                         
                    } else if($(this).val()=="I01_Import_MissingDO_users-sql-Shipment_MissingDO") {
                        $('#datepicker1').attr('disabled', false);     
                        $('#datepicker2').attr('disabled', false);
                        $('#shipment').attr('disabled', false); 
                    } else if($(this).val()=="T04_DW_Delete_PreDO_Shipment-bat-Delete_predo_shipment") {
                        $('#shipment').attr('disabled', false);     
                        $('#cpdo').attr('disabled', false);
                    } else if($(this).val()=="OTM_Split_CPDO_for_Pending_OrderBase-.py-OTM_Split_CPDO_for_Pending_OrderBase") {
                        $('#orderbase').attr('disabled', false);                                                 
                    } else if($(this).val()=="OTM_Change_Shipment_Status_Delivered_All-.py-OTM_Change_Shipment_Status_Delivered_All") {
                        $('#shipment').attr('disabled', false);   
                    } else if($(this).val()=="OTM_Change_Shipment_Status_Completed_All-.py-OTM_Change_Shipment_Status_Completed_All") {
                        $('#shipment').attr('disabled', false);                       
                    } else if($(this).val()=="F07_Import_Freight_master-bat-Freight_master") {
                        $('#filename').attr('disabled', false);
                        $("#filename").val('freight_master');
                    } else if($(this).val()=="I08_Import_OTM_Update_DO_File_RegionCode-bat-update_regioncode") {
                        $('#filename').attr('disabled', false);
                        $("#filename").val('update_regioncode');                      
                    } else if($(this).val()=="I11_Import_Safepac_quota-bat-customer_quota") {
                        $('#filename').attr('disabled', false);
                        $("#filename").val('customer-quota');
                    } else if($(this).val()=="I20_Import_KFA_M_Plant-bat-KFA_insert_plant") {
                        $('#filename').attr('disabled', false);
                        $("#filename").val('KFA_insert_plant');                        
                    } else if($(this).val()=="I20_Import_KFA_M_SensorMaster-bat-KFA_insert_sensor") {
                        $('#filename').attr('disabled', false);
                        $("#filename").val('KFA_insert_sensor');                        
                    } else {
                        $('#datepicker1').attr('disabled', false);     
                        $('#datepicker2').attr('disabled', false);
                        $('#shipment').attr('disabled', false);     
                        $('#cpdo').attr('disabled', false);

                    }                     

                  });
                });
            </script>

            <p><h4>1.Select Template of BOT</h4></p>
            <p><span>BOT Template</span>
            <select id="Bot_with_Parameter" name="name">
            <option value="Use_Below_BOT">Use_Below_BOT</option>
            <option value="F01_FreightCal-sql-DW_Shipment_Report_freight">F01_FreightCal</option>
            <option value="F07_Import_Freight_master-bat-Freight_master">F07_Import_Freight_master</option>
            <option value="I01_Import_MissingDO_users-sql-Shipment_MissingDO">I01_Import_MissingDO_users</option>
            <option value="I03_Import_DO_cost_users-sql-Shipment_cost_by_do">I03_Import_DO_cost_users</option>
            <option value="I08_Import_OTM_Update_DO_File_RegionCode-bat-update_regioncode">I08_Import_OTM_Update_DO_File_RegionCode</option>            
            <option value="I19_Import_OTM_OrderRelease_Hourly_users-sql-OTM_OrderRelease_Hourly">I19_Import_OTM_OrderRelease_Hourly_users</option>
            <option value="I11_Import_Safepac_quota-bat-customer_quota">I11_Import_Safepac_quota</option>            
            <option value="I20_Import_KFA_M_Plant-bat-KFA_insert_plant">I20_Import_KFA_M_Plant</option>
            <option value="I20_Import_KFA_M_SensorMaster-bat-KFA_insert_sensor">I20_Import_KFA_M_SensorMaster</option>                       
            <option value="T04_DW_Delete_PreDO_Shipment-bat-Delete_predo_shipment">T04_DW_Delete_PreDO_Shipment</option>
            <option value="OTM_Split_CPDO_for_Pending_OrderBase-.py-OTM_Split_CPDO_for_Pending_OrderBase">OTM_Split_CPDO_for_Pending_OrderBase</option>            
            <option value="OTM_Change_Shipment_Status_Delivered_All-.py-OTM_Change_Shipment_Status_Delivered_All">OTM_Change_Shipment_Status_Delivered_All</option>
            <option value="OTM_Change_Shipment_Status_Completed_All-.py-OTM_Change_Shipment_Status_Completed_All">OTM_Change_Shipment_Status_Completed_All</option>

            </select></p>
            
            <p><h4>2.Add Parameter</h4></p>
            <p><span>Date From</span><input class="contact" type="text" id="datepicker1" name="date_from" value="" autocomplete="off" disabled=true /></p>
            <p><span>Date To</span><input class="contact" type="text" id="datepicker2" name="date_to" value="" autocomplete="off" disabled=true /></p>
            <p><span>Shipment No.(separate by ,)</span><input class="contact" type="text" id="shipment" name="shipment_no" value="" disabled=true /></p>
            <p><span>CPDO No.(separate by ,)</span><input class="contact" type="text" id="cpdo" name="cpdo_no" value="" disabled=true /></p>
            <p><span>OrderBase No.(XX-10,XX-20)</span><input class="contact" type="text" id="orderbase" name="order_base" value="" disabled=true /></p>
            <p><span>File : Path is in â€¦\Logistics_Reports\Script\ </span><input class="contact" type="text" id="filename" name="file_name" value="" disabled=true /></p>

            <br>
            <p><h4>3.Run BOT with Parameter</h4></p>
            {% csrf_token %}          
            <p style="padding-top: 15px"><span>&nbsp;</span><input class="submit" type="submit" name="ANOTHER" id="bot_param" value="submit" onclick="return GetSelectedText('Bot_with_Parameter')" /></p>
            </div>

            {% if some_flag %}

                <div id="dialog-confirm" title="Complete Run BOT with Parameter ?">
                  <p><span style="float:left; margin:12px 12px 15px 0;"></span>Run BOT with Paramete has been finished <br> Do you want to continue without Log File ?</p>
                </div>

            {% endif %}
        </form>
    
<!-- ############################### End of Admin Group Page ############################################ -->

{% elif group.name == 'lcc'  %} 
         
<!-- ############################### LCC Group Page ##################################################### -->

    <!-- ############## Menu Content ############# -->      
      <div id="menubar">
        <ul id="menu">
          <!-- put class="selected" in the li tag for the selected page - to highlight which page you're on -->
          <li><a href="/">Home</a></li>
          <li><a href="/bot/">Run BOT</a></li>
          <li class="selected"><a href="/another/">BOT & Parameter</a></li>
          <li><a href="/contact/">Contact Us</a></li>
        </ul>
      </div>
    </div>

    <!-- ############## Header Content ############# -->
    <div id="content_header"></div>
    <div id="site_content">
      <div class="sidebar">
        <!-- insert your sidebar items here -->
        <h3>Latest News</h3>
        <h4>New BOT Portal Website Launched</h4>
        <h5>August 02, 2021</h5>
        <p>2021 sees the design and function of our bot portal website. Take a look around and let us know what you think.<br />
        <p></p>

        <h4>Browser Compatibility for Running BOT</h4>
        <p>This template has been tested in the following browsers:</p>
          <li>Google Chrome 6</li>
          <li>Microsoft Edge</li>
          <li>Internet Explorer 7</li>
          <li>FireFox 3.5</li>
          <li>Safari 4</li>
        
        <h3>Search</h3>
        <form method="post" action="#" id="search_form">
          <p>
            <input class="search" type="text" name="search_field" value="Enter keywords....." />
            <input name="search" type="image" style="border: 0; margin: 0 0 -9px 5px;" src="{% static 'search.png' %}" alt="Search" title="Search" />
          </p>
        </form>
      </div>
      
      <!-- ############## Main Content ############# -->
      <div id="content">
        <!-- insert the page content here -->
       <h4>Role : Logistics Control Center (LCC)</h4>
       <h1>BOT Execution with Parameter</h1>
        <p>Below is BOT Template with Parameter</p>
        <form action="" method="post" id="another_form">
        <div class="form_settings">
          
        <script>
            $(function(){
                    $('#Bot_with_Parameter').change(function(){
                        $('input[type=text]').val('');
                        
                        $('#datepicker1').attr('disabled', true);     
                        $('#datepicker2').attr('disabled', true);
                        $('#shipment').attr('disabled', true);     
                        $('#cpdo').attr('disabled',true );
                        $('#filename').attr('disabled', true);

                    if($(this).val()=="Use_Below_BOT") {
                        $('#filename').attr('disabled', true);
                         
                    } else if($(this).val()=="ILM_Change_Shipment_Status-py-ILM_Change_Shipment_Status") {
                        $('#shipment').attr('disabled', false);     
                        $('#cpdo').attr('disabled', true);
                        
                    } else if($(this).val()=="OTM_Merge_Shipments-py-OTM_Merge_Shipments") {
                        $('#shipment').attr('disabled', false);     
                        $('#cpdo').attr('disabled', true);
                                              

                    } else {

                        $('#shipment').attr('disabled', false);     
                        $('#cpdo').attr('disabled', true);

                    }                     

                  });
                });
            </script>

            <p><h4>1.Select SQL of BOT</h4></p>
            <p><span>BOT Name</span>
            <select id="Bot_with_Parameter" name="name">
            <option value="Use_Below_BOT">Use_Below_BOT</option>
            <option value="OTM_Merge_Shipments-.py-OTM_Merge_Shipments">OTM_Merge_Shipments</option>
            <option value="OTM_Change_Shipment_Status_Delivered-.py-OTM_Change_Shipment_Status_Delivered">OTM_Change_Shipment_Status_Delivered</option>
            <option value="Delete_Shipment_Driver_Related-.py-Delete_Shipment_Driver_Related">OTM_Delete_Shipment_Driver_Related</option>
            <option value="ILM_Change_Shipment_Status-.py-ILM_Change_Shipment_Status">ILM_Change_Shipment_Status_Back</option>

            </select></p>
            
            <p><h4>2.Add Parameter</h4></p>
            <p><span>Shipment No.(separate by ,)</span><input class="contact" type="text" id="shipment" name="shipment_no" value="" disabled=true /></p>
            <p><span>CPDO No.(separate by ,)</span><input class="contact" type="text" id="cpdo" name="cpdo_no" value="" disabled=true /></p>
            
            <br>
            <p><h4>3.Run BOT with Parameter</h4></p>
            {% csrf_token %}          
            <p style="padding-top: 15px"><span>&nbsp;</span><input class="submit" type="submit" name="ANOTHER" id="bot_param" value="submit" onclick="return GetSelectedText('Bot_with_Parameter')" /></p>
            </div>

            {% if some_flag %}

                <div id="dialog-confirm" title="Complete Run BOT with Parameter ?">
                  <p><span style="float:left; margin:12px 12px 15px 0;"></span>Run BOT with Paramete has been finished <br> Do you want to continue without Log File ?</p>
                </div>

            {% endif %}

        </form>
    
<!-- ############################### End of LCC Group Page ############################################ -->
        {% endif %}
        
            <!-- ############## Note Remark ############# -->
            <p><br /><br />NOTE: The Parameter box will be eanable or disable by selected BOT in dropdown list box.</p>
          </div>
        </div>
        
      {% endfor %}    
    
    {% else %}
    
    <!-- ############## Footer Content ############# -->
    <div id="footer">
      You are not Logged in for Access BOT Portal : Please Login >>><a href="/login/">Login</a> 
    </div>
    
    {% endif %}
    
    <div id="content_footer"></div>
    <div id="footer">
      Copyright &copy; Siam City Cement. All Rights Reserved 2021 | <a href="https://www.siamcitycement.com/th/our_services/logistics/">INSEE Logistics</a> 
    </div>
  </div>
</body>
</html>
